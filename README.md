# Wait for new image deployed to Harbor

Smart waiting until an image with a given tag an imageSha appears and gets tagged at Harbor Docker repo.
Makes a series of subsequent requests to Harbor API to check if the image already exists there. 

Timing options (interval and timeout) are adjustable.

This action works with Harbor APIv2.0 and higher.

## Inputs
### `hostname`
String with hostname, without protocol and api path.
Use can use here `hostname:port` combination as well `localhost:8080`

### `schema`
Use this if your Harbor instance is http only. 
Valid options are `http` and `https` (default), others are discarded with error.
Default: `https`

### `robot`
Full name Robot or Username. Robot name must include autogenerated path as well.

### `token`
Token or password to access Harbor instance.

### `imageProject`
Harbor project image located in. Part in between Harbor host and image name.

Example:`my.harbor.com/name/alpine:latest` - name is project.

### `imageRepo`
Part, which goes after a project.

Example:`my.harbor.com/name/alpine:latest` - alpine is repo

### `imageTag`
Docker tag we are waiting for.

### `imageSha`
Expected image  SHA256. May start with `sha256:`.

Currently, only SHA256 is supported.

### `interval (optional)`
Time between checks in seconds.
Default: `2 seconds`

### `timeout (optional)`
Time in seconds, after which, script  gives up and action fails if nothing matched was found.
Default: `60 (1 minutes)`

## Example usage
```
uses: kyberorg/wait_for_harbor@v0.1
with:
  hostname: 'my.harbor.com'
  robot: 'robot+name'
  token: robottokenhere
  imageProject: myProject
  imageRepo: myImage
  imageTag: 1.1
  imageSha: sha256:aafdsgwqetwqtwqt
```
